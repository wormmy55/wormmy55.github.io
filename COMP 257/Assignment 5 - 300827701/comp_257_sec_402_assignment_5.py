# -*- coding: utf-8 -*-
"""COMP 257 SEC 402 - Assignment 5.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/174fHIZ7qdd6_EbWyzXNg6abL3kXJOXXv

##Assignment 5 Autoencoders
Name: Jonathan Au <br>
Student #: 300827701 <br>

In this assignment, you will implement an autoencoder that encodes and decodes data using the Olivetti faces dataset.
1.	Use the training set, validation set, and test set from Assignment 3 (Hierarchical Clustering) for this Assignment. [0 points]
2.	Use PCA preserving 99% of the variance to reduce the datasetâ€™s dimensionality as in Assignment 4 (Gaussian Mixture Models) and use it to train the autoencoder [0 points]
3.	Define an autoencoder with the following architecture:        
       
       ![image.png](data:image/png;base64,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)
       <br>
	a) Use k-fold cross validation to fine tune the modelâ€™s learning rate and hyperparameter of the regularizer.  Due to the long training requirements, for the number of hidden units, try two or three different values for each hidden layer. [75 points]<br>
	b) Discuss the rationale with respect to the activation functions and loss function used in your model. [10 points]<br>

Run the best model with the test set and display the original image and the reconstructed image. [15 points]

!pip uninstall tensorflow <br>
!pip install tensorflow==2.17.0
"""

#All imports
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import scipy.cluster.hierarchy as sch

from numpy.linalg import eig
from sklearn.decomposition import PCA
from sklearn.mixture import GaussianMixture
from sklearn.metrics import silhouette_score
from sklearn.preprocessing import MinMaxScaler
from sklearn.preprocessing import StandardScaler
from sklearn.datasets import make_classification
from sklearn.datasets import fetch_olivetti_faces
from sklearn.linear_model import LogisticRegression
from sklearn.cluster import AgglomerativeClustering
from tensorflow.keras.models import load_model, Model
from sklearn.model_selection import StratifiedShuffleSplit
from tensorflow.keras.layers import BatchNormalization, LeakyReLU, Dense, Input
from sklearn.model_selection import cross_val_predict, cross_val_score, train_test_split, KFold

import warnings
warnings.filterwarnings("ignore")

"""1.	Use the training set, validation set, and test set from Assignment 3 (Hierarchical Clustering) for this Assignment. [0 points]"""

# Load olivetti faces
olivetti = fetch_olivetti_faces()
#X = olivetti.data
#Y = olivetti.target
#Z = olivetti.images

X = pd.DataFrame(olivetti["data"])
Y = pd.DataFrame(olivetti["target"])

# Print the description and shapes of the dataset
#print(olivetti.DESCR)
print(X.shape)
print(Y.shape)
#print(Z.shape)

#split into train and test data
X_train, X_val_test, y_train, y_val_test = train_test_split(X, Y, test_size=.665)

#split train data into train and validation data
X_val, X_test, y_val, y_test = train_test_split(X_val_test, y_val_test, test_size=0.5)

#print the shapes of the data
print(X_train.shape)
print(X_test.shape)
print(X_val.shape)

"""2.	Use PCA preserving 99% of the variance to reduce the datasetâ€™s dimensionality as in Assignment 4 (Gaussian Mixture Models) and use it to train the autoencoder [0 points]"""

# Create PCA instance
# set PCA to get 99% of variance
pca = PCA(n_components=0.99)

# Fit train data
ss = StandardScaler()
X_train_scaled = ss.fit_transform(X_train)
pc = pca.fit_transform(X_train_scaled)

X_train_pca = pd.DataFrame(pca.fit_transform(X_train))


# Print the number of components and the explained variance ratio
print ( "Components =", pca.n_components_ , "\nTotal explained variance =",
      round(pca.explained_variance_ratio_.sum(),5)  )

"""3. Define an autoencoder with the following architecture: <br><b>
Input -> Top Hidden: Layer 1 -> Central: Layer 2 -> Top Hidden: Layer 3 -> Output <br></b>
Encoding: Top Hidden: Layer 1 -> Central: Layer 2 <br>
Decoding: Central: Layer 2 -> Top Hidden: Layer 3<br>

"""

# AutoEncoder Model Preparation
n_inputs = X.shape[1]
# define encoder
input_data_shape= Input(shape=(n_inputs,))
# encoder level 1
encoder= Dense(n_inputs*2)(input_data_shape)
encoder = BatchNormalization()(encoder)
encoder= LeakyReLU()(encoder)
# encoder level 2
encoder= Dense(n_inputs)(encoder)
encoder= BatchNormalization()(encoder)
encoder= LeakyReLU()(encoder)
# bottleneck
n_bottleneck = round(float(n_inputs) / 2.0)
bottleneck = Dense(n_bottleneck)(encoder)
# define decoder, level 1
decoder = Dense(n_inputs)(bottleneck)
decoder = BatchNormalization()(decoder)
decoder = LeakyReLU()(decoder)
# decoder level 2
decoder = Dense(n_inputs*2)(decoder)
decoder = BatchNormalization()(decoder)
decoder = LeakyReLU()(decoder)

# output layer
output = Dense(n_inputs, activation='linear')(decoder)
# define autoencoder model
autoencode = Model(inputs=input_data_shape, outputs=output)
# compile autoencoder model
autoencode.compile(optimizer='adam', loss='mse')

autoencode.summary()

"""  a) Use k-fold cross validation to fine tune the modelâ€™s learning rate and hyperparameter of the regularizer. <br>Due to the long training requirements, for the number of hidden units, try two or three different values for each hidden layer. [75 points]"""

#Use K-fold for cross val
kFoldCV = KFold(n_splits=2)
kFoldCV.get_n_splits(X)
print(kFoldCV)

history = autoencode.fit(X_train, y_train, epochs=10, batch_size=16, verbose=2, validation_data=(X_test, y_test))
#print("K Fold CV: \n", history)

#Training classifier for prediction

#y_pred = cross_val_predict(kmean, X_train, y_train, cv=kFoldCV)
#y_pred = cross_val_predict(LogisticRegression(), X_train, y_train, cv=kFoldCV)
#y_pred = cross_val_predict(RandomForestRegressor(), X_train, y_train, cv=kFoldCV)
#print("Y Prediction: ", y_pred)

#score = cross_val_score(LogisticRegression(), X_train, y_train, cv=kFoldCV)
#score = cross_val_score(RandomForestRegressor(), X_train, y_train, cv=kFoldCV)
#print("Score: ", score)

# Plot the training and validation loss
plt.plot(history.history['loss'], label='Training Loss')
plt.plot(history.history['val_loss'], label='Validation Loss')
plt.title('Training and Validation Loss')
plt.xlabel('Epochs')
plt.ylabel('Loss')
plt.legend()
plt.show()

"""b) Discuss the rationale with respect to the activation functions and loss function used in your model. [10 points]
<br><br>
From the graph, it can be seen that the greater the epoch, the lower the loss.

Run the best model with the test set and display the original image and the reconstructed image. [15 points]
"""

plt.title("Original")
plt.imshow(np.array(X_train.iloc[0]).reshape(64,64), cmap="gray")
plt.show()

# generating New faces with Sample()
model = pd.DataFrame(pca.inverse_transform(X_train_pca))

plt.title("Reconstructed")
plt.imshow(np.array(model.iloc[0]).reshape(64,64), cmap="gray")
plt.show()